<div class="profile-container">
  <div class="personal-area-glass">
    <div class="card-body text-center p-0">
      <div class="profile-header">
        <h2 class="mb-2 text-primary">
          <i class="bi bi-shield-lock me-2"></i>Cambia Password
        </h2>
        <p class="mb-4 text-muted">Inserisci la vecchia password e la nuova password</p>
      </div>

      <form (ngSubmit)="onSubmit()" #passwordForm="ngForm">
        <!-- Vecchia password -->
        <div class="form-floating mb-4 password-container">
          <input [type]="showCurrentPassword ? 'text' : 'password'"
                 class="form-control custom-input"
                 id="currentPassword"
                 [(ngModel)]="passwordData.currentPassword"
                 name="currentPassword"
                 placeholder="Password attuale"
                 required>
          <label for="currentPassword">
            <i class="bi bi-key-fill me-2"></i>Password attuale
          </label>
          <button type="button"
                  class="password-toggle"
                  (click)="showCurrentPassword = !showCurrentPassword"
                  tabindex="-1"
                  aria-label="Mostra/Nascondi password attuale">
            <i class="bi" [ngClass]="showCurrentPassword ? 'bi-eye-slash' : 'bi-eye'"></i>
          </button>
        </div>

        <!-- Nuova password -->
        <div class="form-floating mb-4 password-container">
          <input [type]="showNewPassword ? 'text' : 'password'"
                 class="form-control custom-input"
                 id="newPassword"
                 [(ngModel)]="passwordData.newPassword"
                 name="newPassword"
                 placeholder="Nuova password"
                 required>
          <label for="newPassword">
            <i class="bi bi-lock-fill me-2"></i>Nuova password
          </label>
          <button type="button"
                  class="password-toggle"
                  (click)="showNewPassword = !showNewPassword"
                  tabindex="-1"
                  aria-label="Mostra/Nascondi nuova password">
            <i class="bi" [ngClass]="showNewPassword ? 'bi-eye-slash' : 'bi-eye'"></i>
          </button>
        </div>

        <!-- Ripeti nuova password -->
        <div class="form-floating mb-4 password-container">
          <input [type]="showRepeatPassword ? 'text' : 'password'"
                 class="form-control custom-input"
                 id="repeatNewPassword"
                 [(ngModel)]="passwordData.repeatNewPassword"
                 name="repeatNewPassword"
                 placeholder="Ripeti nuova password"
                 required>
          <label for="repeatNewPassword">
            <i class="bi bi-lock-fill me-2"></i>Ripeti nuova password
          </label>
          <button type="button"
                  class="password-toggle"
                  (click)="showRepeatPassword = !showRepeatPassword"
                  tabindex="-1"
                  aria-label="Mostra/Nascondi ripeti password">
            <i class="bi" [ngClass]="showRepeatPassword ? 'bi-eye-slash' : 'bi-eye'"></i>
          </button>
        </div>

        <div class="d-flex justify-content-center gap-3">
          <button type="submit"
                  class="btn btn-outline-primary px-4"
                  [disabled]="!passwordForm.form.valid">
            <i class="bi bi-check2-circle me-2"></i>Salva
          </button>
          <button type="button"
                  class="btn btn-outline-secondary px-4"
                  (click)="goBack()">
            <i class="bi bi-arrow-left me-2"></i>Indietro
          </button>
        </div>
      </form>

      <div *ngIf="errorMessage" class="alert alert-danger mt-4">
        <i class="bi bi-exclamation-triangle-fill me-2"></i>{{ errorMessage }}
      </div>
      <div *ngIf="successMessage" class="alert alert-success mt-4">
        <i class="bi bi-check-circle-fill me-2"></i>{{ successMessage }}
      </div>
    </div>
  </div>
</div>
