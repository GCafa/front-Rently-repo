<div class="container py-4">
  <h2 class="mb-4 text-center custom-primary">Dashboard Host</h2>

  <!-- Filtri -->
  <div class="card shadow-sm mb-4 border-0 rounded-4">
    <div class="card-body p-4">
      <h5 class="card-title mb-3"><i class="bi bi-funnel me-2"></i>Filtra prenotazioni</h5>

      <!-- Appartamento -->
      <div class="mb-3">
        <label class="form-label">Appartamento</label>
        <select class="form-select" [(ngModel)]="selectedApartment">
          <option value="">Tutti gli appartamenti</option>
          <option *ngFor="let apt of apartments" [value]="apt.title">{{ apt.title }}</option>
        </select>
      </div>

      <!-- Date -->
      <div class="row g-3 mb-3">
        <div class="col-md-4">
          <input type="date" class="form-control" placeholder="Dal" [(ngModel)]="fromDate">
        </div>
        <div class="col-md-4">
          <input type="date" class="form-control" placeholder="Al" [(ngModel)]="toDate">
        </div>
        <div class="col-md-4 d-flex justify-content-between">
          <button class="btn btn-primary w-100 me-2" (click)="applyFilters()">Applica Filtri</button>
          <button class="btn btn-secondary w-100" (click)="resetFilters()">Reset</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Loading -->
  <div *ngIf="loading" class="text-center my-5">
    <div class="spinner-border text-primary" role="status"></div>
    <p class="mt-2">Caricamento prenotazioni...</p>
  </div>

  <!-- Error -->
  <div *ngIf="errorMessage" class="alert alert-danger text-center">
    <i class="bi bi-exclamation-triangle-fill me-2"></i>
    {{ errorMessage }}
  </div>

  <!-- Totale -->
  <div *ngIf="!loading && bookings.length > 0" class="mb-3 text-end">
    <h5><strong>Guadagno Totale:</strong> €{{ totalEarnings }}</h5>
  </div>

  <!-- Prenotazioni -->
  <div *ngIf="!loading && bookings.length > 0" class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
    <div class="col" *ngFor="let booking of bookings">
      <div class="card h-100 shadow-sm rounded-4 p-3">
        <h5 class="card-title">{{ booking.title }}</h5>
        <p class="card-text mb-1"><strong>Ospite:</strong> {{ booking.user.firstname }} {{ booking.user.lastname }}</p>
        <p class="card-text mb-1"><strong>Check In:</strong> {{ booking.checkInDate }}</p>
        <p class="card-text mb-1"><strong>Check Out:</strong> {{ booking.checkOutDate }}</p>
        <p class="card-text"><strong>Totale:</strong> €{{ booking.total }}</p>
      </div>
    </div>
  </div>

  <!-- Nessun risultato -->
  <div *ngIf="!loading && bookings.length === 0" class="text-center text-muted fs-5 mt-4">
    Nessuna prenotazione trovata per i filtri selezionati.
  </div>
</div>
